# 2020_3_14组合模块等知识学习
### 1.容器的概念
#### 分类
 > 1.布局容器：这个容器和之前的容器是一致的，容器可以用来对子组件进行布局以及批量操作组件。  
 > 2.条件容器：这个可以绑定一个变量控制下面的组件是否显示隐藏。  
 >> 通常有三种方式控制其是否显示。  
 >>直接绑定：通过绑定状态数据控制条件容器子组件的显示隐藏。  
 >>>  你可以在状态文件my_store_web_pc.js中的state里声明你的状态，然后在容器的配置里
 找到这些状态进行绑定。
 
 >>匹配条件：支持对一个或两个绑定变量进行比较操作或简单的运算计算属性：  
 >>绑定计算属性的返回值作为显示隐藏执行代码：直接执行简单的表达控制显示隐藏  
 
> 3.循环容器：这个容器可以绑定一个列表，实现循环显示多个条目，列表页和动态模块比较常用。  
> 4.弹出层容器：这个容器可以快速制作弹出层  （需要理解一下其具体意义）

### 2.组件使用的小技巧
#### 1.动态绑定
> 容器的设置菜单中可以为它绑定一些属性以及事件，例如动态绑定其class属性用于管理其样式。
> 有关事件的绑定，首先需要在控制器中添加一个function，右键可以添加他的子函数，最简单的方式
> 就是调用系统接口，然后sweetalert（"hello world"）.在容器或者按钮中，都可以增加event监听

#### 2.文本限制行数
> 有些场景需要你限制文本的宽度以及行数，当内容超过限制时则显示部分内容加省略号。
> 你可以在原子组件中，从文本->文本（限制行数和宽度）。找到这个组件以后选用，在其内部设置行数以及宽度。

#### 3.容器内部组件布局  
> 有些场景对于容器内部组件对齐方式有较高的要求，最简单的设置方法就是在容器的设置页面，对于容器选项进行配置。
> 例如水平居中垂直居中等。

#### 4.弹出层的处理
> 通过条件容器下在放置一个弹出层。可以实现根据事件监听决定是否显示或关闭弹出层内容。

#### 5.表单的双向绑定
> 可以在容器中添加一个原子组件中的输入框，输入框配置界面可以选择其应当绑定的value值。下方可以选择是否进行双向绑定。
> 选择以后，就可以通过编辑输入框同时也修改state中的值。

#### 6.循环容器的使用
> 最简单的一个循环容器使用。首先你在控制器中，对于onCreateState生命周期下声明一个简单的列表。
> 比如list = [1,2,3,4]  
> 然后添加一个循环容器，循环容器中简单增加一个按钮。循环容器设置页绑定该容器循环的列表为list。  
> 然后你就会看到页面上出现了4个按钮，按钮的设置页面可以设置value值得绑定，简单的可以绑定循环条目或者循环索引
> 循环条目就是指你的列表中的每个子项的值。索引就是index.

#### 7.商城列表页以及详情页制作总结
> 列表页正常的流程是：  
>> 简单配置一下列表页的布局，主要内容是循环容器->循环容器中添加子组合模块->对于每个组合模块配置布局
->控制器添加流程->容器内的组件绑定数据->完成  

> 主要说说控制器内的操作：  
>> 通常一开始onCreateState生命周期都声明一些空的数据或者空的列表，用于展示或者遍历。  
>> 小程序中还有上划以及下拉到底两个监听比较常用。通常手指下滑表示用户想刷新页面，因此可以执行初始化操作，
上划到底代表用户不断地向下浏览，并且到了数据库加载完成的底端。因此应该显示已经到底了这样的字样。  
>> 在用于加载列表数据的函数中，通常需要设置每次加载的最大限制（limit）以及加载内容的偏移量(offset)
每当调用系统接口，查询数据的时候，需要传入参数（limit以及offset）方便我们更好的获取数据以及前端更新。

>>分页查询数据，当用户再次向下刷新触底的时候，又会再次触发一次加载函数，这次查询结果就带有偏移量，同时在更新前端
items的时候，对这个列表（数组）进行更新，实际上是将新查询到的数据列表拼接到旧的列表之后，并展示。常规用法是js的concat函数。
但是系统提供了更加方便的item__uconcat：{field:'id',list:actionXX.objects}的形式更新。  
>>最后是跳转过程，比较方便的方式是调用系统接口中的dw.app.gotoPappUrl这个接口。只需要在参数中选择需要的页面，以及你需要传入的参数即可。
为了方便起见，可以直接传入触发点击事件的event.context.eventData.id 但是千万不要忘记在你所需要跳转的点击元素上绑定其点击是传入的参数。这个传入的参数对应的就是点击事件的eventData。如果你忘记了这些复杂的数据的结构，可以打印一下。  
#### 8.控制器数据库查询
>> 外键查询  
>> 如果在产品列表页面中，需要查询分类名称为分类1的产品。但是产品表中储存的实际上是分类的uuid，因此可以通过外键查询，
选中你需要使用的外键，下方条件中直接根据外键表中的信息匹配就可以了。

>> 反向外键查询  
>> 如果你查询分类表，根据制定的分类可以查到关联该分类的产品列表

